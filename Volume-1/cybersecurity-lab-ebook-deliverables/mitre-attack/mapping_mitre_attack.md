# üéØ Mapping MITRE ATT&CK - Lab de Cybers√©curit√©

---

## üìñ Introduction

Ce document mappe les techniques et tactiques MITRE ATT&CK avec les exercices pratiques du lab de cybers√©curit√©. Chaque exercice est associ√© √† des techniques sp√©cifiques du framework MITRE ATT&CK pour une compr√©hension professionnelle des vecteurs d'attaque.

**MITRE ATT&CK** : Framework de connaissances bas√© sur l'observation des tactiques et techniques utilis√©es par les adversaires dans le monde r√©el.

**R√©f√©rence** : https://attack.mitre.org/

---

## üîµ Vue d'ensemble des Tactiques

| **Tactique** | **ID** | **Description** | **Utilis√© dans le Lab** |
|--------------|--------|-----------------|---------------------------|
| **Reconnaissance** | TA0043 | Collecte d'informations sur la cible | ‚úì Oui |
| **Resource Development** | TA0042 | Pr√©paration des ressources d'attaque | ‚úì Oui |
| **Initial Access** | TA0001 | Obtenir l'acc√®s initial au syst√®me | ‚úì Oui |
| **Execution** | TA0002 | Ex√©cuter du code malveillant | ‚úì Oui |
| **Persistence** | TA0003 | Maintenir l'acc√®s au syst√®me | ‚úì Oui |
| **Privilege Escalation** | TA0004 | Obtenir des privil√®ges √©lev√©s | ‚úì Oui |
| **Defense Evasion** | TA0005 | √âviter la d√©tection | ‚úì Oui |
| **Credential Access** | TA0006 | Voler des identifiants | ‚úì Oui |
| **Discovery** | TA0007 | Explorer l'environnement | ‚úì Oui |
| **Lateral Movement** | TA0008 | Se d√©placer dans le r√©seau | ‚úì Oui |
| **Collection** | TA0009 | Collecter des donn√©es d'int√©r√™t | ‚úì Oui |
| **Command and Control** | TA0011 | Communiquer avec les syst√®mes compromis | ‚úì Oui |
| **Exfiltration** | TA0010 | Exfiltrer des donn√©es | ‚úì Oui |
| **Impact** | TA0040 | Perturber les op√©rations | Non (lab) |

---

## üí° Exercice 1 : Reconnaissance R√©seau (Niveau Facile)

### Objectif
Scanner un r√©seau, identifier les h√¥tes actifs et les services expos√©s.

### Techniques MITRE ATT&CK Utilis√©es

| **Technique** | **ID** | **Tactique** | **Description** | **Commande Lab** |
|---------------|--------|--------------|-----------------|------------------|
| **Active Scanning** | T1595 | Reconnaissance | Scanner activement les cibles pour collecter des informations | `nmap -sn 192.168.100.0/24` |
| **Active Scanning: Scanning IP Blocks** | T1595.001 | Reconnaissance | Scanner des blocs d'adresses IP | `nmap -sS 192.168.100.0/24` |
| **Active Scanning: Vulnerability Scanning** | T1595.002 | Reconnaissance | Scanner pour identifier les vuln√©rabilit√©s | `nmap --script vuln 192.168.100.20` |
| **Network Service Discovery** | T1046 | Discovery | D√©couvrir les services r√©seau disponibles | `nmap -sV -p- 192.168.100.20` |
| **System Network Configuration Discovery** | T1016 | Discovery | D√©couvrir la configuration r√©seau | `nmap -O 192.168.100.20` |

### Outils Utilis√©s
- **Nmap** : Scanner de r√©seau et de ports
- **Netdiscover** : D√©couverte d'h√¥tes via ARP

### D√©tection & Mitigation
- **D√©tection** : IDS/IPS (Suricata, Snort) peut d√©tecter les scans de ports
- **Mitigation** : 
  - Limiter l'exposition des services
  - Utiliser un pare-feu pour bloquer les scans
  - Impl√©menter le rate limiting

---

## üî´ Exercice 2 : Exploitation Web (Niveau Interm√©diaire)

### Objectif
Scanner une application web, identifier et exploiter une vuln√©rabilit√© (SQL Injection).

### Techniques MITRE ATT&CK Utilis√©es

| **Technique** | **ID** | **Tactique** | **Description** | **Commande Lab** |
|---------------|--------|--------------|-----------------|------------------|
| **Exploit Public-Facing Application** | T1190 | Initial Access | Exploiter une vuln√©rabilit√© dans une application web | `sqlmap -u "http://192.168.100.20/page.php?id=1"` |
| **Web Service: Exploit via Web Service** | T1505.003 | Persistence | Exploiter un service web pour maintenir l'acc√®s | Exploitation SQLi pour obtenir shell |
| **Credential Dumping** | T1003 | Credential Access | Extraire des identifiants de la base de donn√©es | `sqlmap -u "..." --passwords` |
| **Data from Information Repositories** | T1213 | Collection | Collecter des donn√©es depuis la base de donn√©es | `sqlmap -u "..." --dump` |
| **Command and Scripting Interpreter: Unix Shell** | T1059.004 | Execution | Ex√©cuter des commandes via shell | `sqlmap -u "..." --os-shell` |

### Outils Utilis√©s
- **Nikto** : Scanner de vuln√©rabilit√©s web
- **SQLMap** : Outil d'exploitation SQL Injection
- **Burp Suite** : Proxy d'interception et scanner web

### D√©tection & Mitigation
- **D√©tection** : WAF (Web Application Firewall) peut d√©tecter les tentatives d'injection
- **Mitigation** :
  - Utiliser des requ√™tes pr√©par√©es (prepared statements)
  - Valider et assainir toutes les entr√©es utilisateur
  - Impl√©menter un WAF

---

## üîê Exercice 3 : Post-Exploitation (Niveau Avanc√©)

### Objectif
Obtenir un acc√®s initial, escalader les privil√®ges, √©tablir la persistence et exfiltrer des donn√©es.

### Sc√©nario : Exploitation vsftpd backdoor + Post-exploitation

### Techniques MITRE ATT&CK Utilis√©es

| **Technique** | **ID** | **Tactique** | **Description** | **Commande Lab** |
|---------------|--------|--------------|-----------------|------------------|
| **Exploit Public-Facing Application** | T1190 | Initial Access | Exploiter la backdoor vsftpd | `use exploit/unix/ftp/vsftpd_234_backdoor` |
| **Command and Scripting Interpreter** | T1059 | Execution | Ex√©cuter des commandes via shell | Commandes dans le shell obtenu |
| **System Information Discovery** | T1082 | Discovery | D√©couvrir les informations syst√®me | `uname -a`, `cat /etc/issue` |
| **File and Directory Discovery** | T1083 | Discovery | Explorer le syst√®me de fichiers | `ls -la /home`, `find / -name "*.txt"` |
| **Account Discovery** | T1087 | Discovery | √ânum√©rer les comptes utilisateurs | `cat /etc/passwd` |
| **Permission Groups Discovery** | T1069 | Discovery | Identifier les groupes et permissions | `id`, `groups` |
| **OS Credential Dumping** | T1003 | Credential Access | Extraire les hashes de mots de passe | `cat /etc/shadow` |
| **Create Account** | T1136 | Persistence | Cr√©er un compte backdoor | `useradd backdoor && echo "backdoor:pass" \| chpasswd` |
| **Scheduled Task/Job: Cron** | T1053.003 | Persistence | Ajouter une t√¢che cron pour persistence | `echo "* * * * * /bin/bash -i" \| crontab` |
| **Valid Accounts** | T1078 | Persistence | Utiliser des comptes valides pour maintenir l'acc√®s | Connexion avec le compte cr√©√© |
| **Data from Local System** | T1005 | Collection | Collecter des fichiers sensibles | `cat /etc/shadow > /tmp/shadow.txt` |
| **Archive Collected Data** | T1560 | Collection | Archiver les donn√©es collect√©es | `tar -czf /tmp/loot.tar.gz /tmp/shadow.txt` |
| **Exfiltration Over C2 Channel** | T1041 | Exfiltration | Exfiltrer via le canal C2 | Transfert via netcat ou autre |

### Outils Utilis√©s
- **Metasploit Framework** : Exploitation
- **LinPEAS** : Enum√©ration post-exploitation
- **Netcat** : Transfert de fichiers

### D√©tection & Mitigation
- **D√©tection** : 
  - SIEM pour corr√©lation d'√©v√©nements
  - EDR pour d√©tecter les comportements suspects
  - Monitoring des cr√©ations de comptes
- **Mitigation** :
  - Mettre √† jour tous les services
  - Impl√©menter le principe du moindre privil√®ge
  - Monitoring actif et alertes

---

## üõ°Ô∏è Autres Sc√©narios du Lab

### Sc√©nario : Brute-force SSH

| **Technique** | **ID** | **Tactique** | **Description** | **Commande Lab** |
|---------------|--------|--------------|-----------------|------------------|
| **Brute Force: Password Guessing** | T1110.001 | Credential Access | Deviner les mots de passe par brute-force | `hydra -l root -P rockyou.txt ssh://192.168.100.20` |
| **Valid Accounts: Local Accounts** | T1078.003 | Initial Access | Utiliser un compte local compromise | `ssh msfadmin@192.168.100.20` |

### Sc√©nario : Exploitation Samba

| **Technique** | **ID** | **Tactique** | **Description** | **Commande Lab** |
|---------------|--------|--------------|-----------------|------------------|
| **Exploitation of Remote Services** | T1210 | Lateral Movement | Exploiter Samba pour ex√©cution de code | `use exploit/multi/samba/usermap_script` |
| **Remote Services: SMB/Windows Admin Shares** | T1021.002 | Lateral Movement | Utiliser SMB pour mouvement lat√©ral | `smbclient //192.168.100.20/share` |

### Sc√©nario : Capture de trafic r√©seau

| **Technique** | **ID** | **Tactique** | **Description** | **Commande Lab** |
|---------------|--------|--------------|-----------------|------------------|
| **Network Sniffing** | T1040 | Credential Access | Capturer le trafic r√©seau pour intercepter des credentials | `tcpdump -i eth0 -w capture.pcap` |
| **Man-in-the-Middle** | T1557 | Credential Access | Intercepter les communications | ARP spoofing + Wireshark |

---

## üìä Matrice de Mapping Compl√®te

### Tableau R√©capitulatif par Exercice

| **Exercice** | **Niveau** | **Tactiques** | **Techniques** | **Nombre de Techniques** |
|--------------|------------|---------------|----------------|---------------------------|
| **Reconnaissance R√©seau** | Facile | Reconnaissance, Discovery | T1595, T1595.001, T1595.002, T1046, T1016 | 5 |
| **Exploitation Web** | Interm√©diaire | Initial Access, Persistence, Credential Access, Collection, Execution | T1190, T1505.003, T1003, T1213, T1059.004 | 5 |
| **Post-Exploitation** | Avanc√© | Initial Access, Execution, Discovery, Credential Access, Persistence, Collection, Exfiltration | T1190, T1059, T1082, T1083, T1087, T1069, T1003, T1136, T1053.003, T1078, T1005, T1560, T1041 | 13 |
| **Brute-force SSH** | Interm√©diaire | Credential Access, Initial Access | T1110.001, T1078.003 | 2 |
| **Exploitation Samba** | Interm√©diaire | Lateral Movement | T1210, T1021.002 | 2 |
| **Capture Trafic** | Interm√©diaire | Credential Access | T1040, T1557 | 2 |

### **Total : 29 techniques MITRE ATT&CK couvertes dans le lab**

---

## üìà Distribution des Techniques par Tactique

| **Tactique** | **Nombre de Techniques** | **Pourcentage** |
|--------------|--------------------------|------------------|
| Discovery | 5 | 17% |
| Credential Access | 4 | 14% |
| Initial Access | 3 | 10% |
| Execution | 2 | 7% |
| Persistence | 3 | 10% |
| Collection | 2 | 7% |
| Exfiltration | 1 | 3% |
| Lateral Movement | 2 | 7% |
| Reconnaissance | 3 | 10% |

---

## üéì Progression P√©dagogique

### Niveau D√©butant
**Exercice 1 : Reconnaissance R√©seau**
- Introduction aux scans r√©seau
- Compr√©hension de la topologie
- Identification des services

**Techniques apprises** :
- T1595 : Active Scanning
- T1046 : Network Service Discovery
- T1016 : System Network Configuration Discovery

### Niveau Interm√©diaire
**Exercice 2 : Exploitation Web**
- Scan de vuln√©rabilit√©s web
- Exploitation SQL Injection
- Acc√®s aux bases de donn√©es

**Techniques apprises** :
- T1190 : Exploit Public-Facing Application
- T1213 : Data from Information Repositories

### Niveau Avanc√©
**Exercice 3 : Post-Exploitation Compl√®te**
- Obtention acc√®s initial
- √ânum√©ration du syst√®me
- Escalade de privil√®ges
- Persistence
- Exfiltration

**Techniques apprises** : 13 techniques compl√®tes

---

## üîç D√©tection & D√©fense par Technique

### T1595 - Active Scanning

**D√©tection** :
- Surveillance des connexions r√©seau inhabituelles
- IDS/IPS (Suricata, Snort)
- Logs firewall

**Mitigation** :
- Rate limiting
- G√©o-blocking
- Honeypots

### T1190 - Exploit Public-Facing Application

**D√©tection** :
- WAF (Web Application Firewall)
- Analyse des logs d'application
- Monitoring des erreurs 500

**Mitigation** :
- Patchs r√©guliers
- Input validation
- Principe du moindre privil√®ge

### T1110.001 - Brute Force: Password Guessing

**D√©tection** :
- Fail2ban
- Monitoring des √©checs de connexion
- SIEM alerts

**Mitigation** :
- MFA (Multi-Factor Authentication)
- Account lockout policies
- Strong password policies

### T1003 - OS Credential Dumping

**D√©tection** :
- EDR (Endpoint Detection and Response)
- Monitoring acc√®s √† /etc/shadow
- Process monitoring

**Mitigation** :
- Least privilege
- Password hashing sal√©
- File integrity monitoring

---

## üìä Matrice de Couverture MITRE ATT&CK

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   MITRE ATT&CK COVERAGE                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Reconnaissance     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 80% (4/5 techniques)          ‚îÇ
‚îÇ Resource Dev.      ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  0% (0/5 techniques)          ‚îÇ
‚îÇ Initial Access     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 60% (3/5 techniques)          ‚îÇ
‚îÇ Execution          ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 40% (2/5 techniques)          ‚îÇ
‚îÇ Persistence        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 60% (3/5 techniques)          ‚îÇ
‚îÇ Privilege Esc.     ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 30% (2/7 techniques)          ‚îÇ
‚îÇ Defense Evasion    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  0% (0/10 techniques)         ‚îÇ
‚îÇ Credential Access  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 80% (4/5 techniques)          ‚îÇ
‚îÇ Discovery          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% (5/5 techniques)         ‚îÇ
‚îÇ Lateral Movement   ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 40% (2/5 techniques)          ‚îÇ
‚îÇ Collection         ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 40% (2/5 techniques)          ‚îÇ
‚îÇ C&C                ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  0% (0/5 techniques)          ‚îÇ
‚îÇ Exfiltration       ‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 20% (1/5 techniques)          ‚îÇ
‚îÇ Impact             ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  0% (0/5 techniques)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Couverture globale** : ~35% des techniques MITRE ATT&CK  
**Focus principal** : Discovery, Credential Access, Initial Access

---

## üéØ Exercices Pratiques Bonus

### Exercice 4 : Privilege Escalation Linux

**Objectif** : Escalader de user √† root

**Techniques MITRE** :
- T1068 : Exploitation for Privilege Escalation
- T1548 : Abuse Elevation Control Mechanism

**Steps** :
1. √ânum√©ration initiale avec LinPEAS
2. Identification de SUID binaries
3. Exploitation
4. Obtention root shell

### Exercice 5 : Lateral Movement

**Objectif** : Se d√©placer d'une machine compromise √† une autre

**Techniques MITRE** :
- T1021.001 : Remote Services: SSH
- T1021.002 : Remote Services: SMB

**Steps** :
1. R√©cup√©ration credentials sur machine 1
2. Identification des autres machines
3. Connexion SSH/SMB vers machine 2
4. R√©p√©ter le processus

---

## üìö Ressources pour Approfondir

### MITRE ATT&CK
- **Site officiel** : https://attack.mitre.org/
- **Navigator** : https://mitre-attack.github.io/attack-navigator/
- **D3FEND** (d√©fense) : https://d3fend.mitre.org/

### Bases de donn√©es de Techniques
- **CAPEC** : Common Attack Pattern Enumeration
- **CWE** : Common Weakness Enumeration
- **CVE** : Common Vulnerabilities and Exposures

### Formations MITRE ATT&CK
- **ATT&CK for CTI** : https://attack.mitre.org/resources/training/cti/
- **MITRE Engage** : https://engage.mitre.org/

---

## ‚úÖ Checklist d'Utilisation

Pour chaque exercice r√©alis√© :

- [ ] Identifier les techniques MITRE ATT&CK utilis√©es
- [ ] Noter les ID des techniques (Txxxx)
- [ ] Comprendre la tactique associ√©e
- [ ] Documenter les commandes utilis√©es
- [ ] Rechercher les m√©thodes de d√©tection
- [ ] Proposer des mitigations
- [ ] Cr√©er un rapport avec mapping MITRE

---

## üîó Int√©gration dans les Rapports

### Template de Section MITRE dans un Rapport

```markdown
## Mapping MITRE ATT&CK

### Techniques Utilis√©es

| ID | Technique | Tactique | Description |
|----|-----------|----------|-------------|
| T1595 | Active Scanning | Reconnaissance | Scan Nmap du r√©seau cible |
| T1190 | Exploit Public-Facing Application | Initial Access | Exploitation vsftpd backdoor |
| T1059 | Command and Scripting Interpreter | Execution | Shell bash obtenu |

### Matrice ATT&CK

[Ins√©rer capture d'√©cran du Navigator MITRE]

### Recommandations de D√©tection

Pour T1595 (Active Scanning) :
- Impl√©menter IDS/IPS
- Configurer des alertes sur les scans de ports
- Utiliser honeypots
```

---

## üéì Conclusion

Ce mapping MITRE ATT&CK couvre **29 techniques** r√©parties sur **9 tactiques** diff√©rentes. Il fournit une base solide pour :

‚úÖ Comprendre les vecteurs d'attaque r√©els  
‚úÖ Documenter professionnellement les tests  
‚úÖ Communiquer avec les √©quipes SOC  
‚úÖ Se pr√©parer aux certifications (OSCP, GIAC, etc.)  
‚úÖ Contribuer √† la Threat Intelligence  

**Le framework MITRE ATT&CK est devenu le langage universel de la cybers√©curit√© offensive et d√©fensive.**

---

*Derni√®re mise √† jour : Janvier 2025*  
*Bas√© sur MITRE ATT&CK v14*